const util = require('util');
const rp = util.promisify(require('request'));
const fs = require('fs');

const headers = {
    'Connection': 'keep-alive',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
    'Accept-Language': 'en-US,en;q=0.9'
};

let dataString1 = 'javax.faces.partial.ajax=true&javax.faces.source=j_idt248&javax.faces.partial.execute=%40all&javax.faces.partial.render=submissioninput&j_idt248=j_idt248&rnahybrid_function_rnahybrid_input_form=rnahybrid_function_rnahybrid_input_form&j_idt62=2&j_idt78=%3EFZD4-201+utr3%3Aprotein_coding%0D%0AGGCTAGTCAGCCTCCATGCTTTCTTCATTTTGAAGGGGGGAATGCCAGCATTTTGGAGGA%0D%0AAATTCTACTAAAAGTTTTATGCAGTGAATCTCAGTTTGAACAAACTAGCAACAATTAAGT%0D%0AGACCCCCGTCAACCCACTGCCTCCCACCCCGACCCCAGCATCAAAAAACCAATGATTTTG%0D%0ACTGCAGACTTTGGAATGATCCAAAATGGAAAAGCCAGTTAGAGGCTTTCAAAGCTGTGAA%0D%0AAAATCAAAACGTTGATCACTTTAGCAGGTTGCAGCTTGGAGCGTGGAGGTCCTGCCTAGA%0D%0ATTCCAGGAAGTCCAGGGCGATACTGTTTTCCCCTGCAGGGTGGGATTTGAGCTGTGAGTT%0D%0AGGTAACTAGCAGGGAGAAATATTAACTTTTTTAACCCTTTACCATTTTAAATACTAACTG%0D%0AGGTCTTTCAGATAGCAAAGCAATCTATAAACACTGGAAACGCTGGGTTCAGAAAAGTGTT%0D%0AACAAGAGTTTTATAGTTTGGCTGATGTAACATAAACATCTTCTGTGGTGCGCTGTCTGCT%0D%0AGTTTAGAACTTTGTGGACTGCACTCCCAAGAAGTGGTGTTAGAATCTTTCAGTGCCTTTG%0D%0ATCATAAAACAGTTATTTGAACAAACAAAAGTACTGTACTCACACACATAAGGTATCCAGT%0D%0AGGATTTTTCTTCTCTGTCTTCCTCTCTTAAATTTCAACATCTCTCTTCTTGGCTGCTGCT%0D%0AGTTTTCTTCATTTTATGTTAATGACTCAAAAAAGGTATTTTTATAGAATTTTTGTACTGC%0D%0AAGCATGCTTAAAGAGGGGAAAAGGAAGGGTGATTCACTTTCTGACAATCACTTAATTCAG%0D%0AAGGAAAATGAGATTTACTAAGTTGACTTACCTGACGGACCCCAGAGACCTATTGCATTGA%0D%0AGCAGTGGGGACTTAATATATTTTACTTGTGTGATTGCATCTATGCAGACGCCAGTCTGGA%0D%0AAGAGCTGAAATGTTAAGTTTCTTGGCAACTTTGCATTCACACAGATTAGCTGTGTAATTT%0D%0ATTGTGTGTCAATTACAATTAAAAGCACATTGTTGGACCATGACATAGTATACTCAACTGA%0D%0ACTTTAAAACTATGGTCAACTTCAACTTGCATTCTCAGAATGATAGTGCCTTTAAAAATTT%0D%0ATTTTATTTTTTAAAGCATAAGAATGTTATCAGAATCTGGTCTACTTAGGACAATGGAGAC%0D%0ATTTTTCAGTTTTATAAAGGGAACTGAGGACAGCTAATCCAACTACTTGGTGCGTAATTGT%0D%0ATTCCTAGTAATTGGCAAAGGCTCCTTGTAAGATTTCACTGGAGGCAGTGTGGCCTGGAGT%0D%0AATTTATATGGTGCTTAATGAATCTCCAGAATGCCAGCCAGAAGCCTGATTGGTTAGTAGG%0D%0AGAATAAAGTGTAGACCATATGAAATGAACTGCAAACTCTAATAGCCCAGGTCTTAATTGC%0D%0ACTTTAGCAGAGGTATCCAAAGCTTTTAAAATTTATGCATACGTTCTTCACAAGGGGGTAC%0D%0ACCCCAGCAGCCTCTCGAAAATTGCACTTCTCTTAAAACTGTAACTGGCCTTTCTCTTACC%0D%0ATTGCCTTAGGCGTTCTAATCATGAGATCTTGGGGACAAATTGACTATGTCACAGGTTGCT%0D%0ACTCCTTGTAACTCATACCTGTCTGCTTCAGCAACTGCTTTGCAATGACATTTATTTATTA%0D%0AATTCATGCCTTAAAAAAATAGGAAGGGAAGCTTTTTTTTTTCTTTTTTTTTTTTTCAATC%0D%0AACACTTTGTGGAAAAACATTTCCAGGGACTCAAAATTCCAAAAAGGTGGTCAAATTCTGG%0D%0AAAGTAAGCATTTCCTCTTTTTTAAAAATTTGGTTTGAGCCTTATGCCCATAGTTTGACAT%0D%0ATTCCCTTTCTTCTTTCCTTTTTGTTTTTGTGTGGTTCTTGAGCTCTCTGACATCAAGATG%0D%0ACATGTAAAGTCGATTGTATGTTTTGGAAGGCAAAGTCTTGGCTTTTGAGACTGAAGTTAA%0D%0AGTGGGCACAGGTGGCCCCTGCTGCTGTGCCCAGTCTGAGTACCTTGGCTAGACTCTAGGT%0D%0ACAGGCTCCAGGAGCATGAGAATTGATCCCCAGAAGAACCATTTTAACTCCATCTGATACT%0D%0ACCATTGCCTATGAAATGTAAAATGTGAACTCCCTGTGCTGCTTGTAGACAGTTCCCATAA%0D%0ACTGTCCACGGCCCTGGAGCACGCACCCAGGGGCAGAGCCTGCCCTTACTCACGCTCTGCT%0D%0ACTGGTGTCTTGGGAGTTGTGCAGGGACTCTGGCCCAGGCAGGGGAAGGAAGACCAGGCGG%0D%0ATAGGGGACTGGTCTTGCTGTTAGAGTATAGAGGTTTGTAATGCAGTTTTCTTCATAATGT%0D%0AGTCAGTGATTGTGTGACCAAGGCAGCATCTAGCAGAAAGCCAGGCATGGAGTAGGTGATC%0D%0AGATACTTGTCAATGACTAAATAATAACAATAAAAGAGCACTTGGGTGAATCTGGGCACCT%0D%0AGATTTCTGAGTTTTGAGTTCTGGAGCTAGTGTTTTGACAATGCTTTGGGTTTTGACATGC%0D%0ACTTTTCCACAAATCTCTTGCCTTTTCAGGGCAAAGTGTATTTGATCAGAAGTGGCCATTT%0D%0AGGATTAGTAGCCTTAGCAATGCTACAGGGTTATAGGCCTCTCCTTTCACATTCCAGACAA%0D%0ATGGAGAGTGTTTATGGTTTCAGGAAAAGAACTTTGTGGCTGAGGGGTCAGTTACCAGTGA%0D%0ACCTTCAATCAACTCCATCACTTCTTAAATCGGTATTTGTTAAAAAAATCAGTTATTTTAT%0D%0ATTATTGAGTGCCGACTGTAGTAAAGCCCTGAAATAGATAATCTCTGTTCTTCTAACTGAT%0D%0ACTAGGATGGGGACGCACCCAGGTCTGCTGAACTTTACTGTTCCTCTGGGAAAGGAGCAGG%0D%0AGACCTCTGGAATTCCCATCTGTTTCACTGTCTCCATTCCATAAATCTCTTCCTGTGTGAG%0D%0ACCACCACACCCAGCCTGGGTCTCTCTACTTTTAACACATCTCTCATCCCTTTCCCAGGAT%0D%0ATCCTTCCAAGTCAGTTACAGGTGGTTTTAACAGAAAGCATCAGCTCTGCTTCGTGACAGT%0D%0ACTCTGGAGAAATCCCTTAGGAAGACTATGAGAGTAGGCCACAAGGACATGGGCCCACACA%0D%0ATCTGCTTTGGCTTTGCCGGCAATTCAGGGCTTGGGGTATTCCATGTGACTTGTATAGGTA%0D%0ATATTTGAGGACAGCATCTTGCTAGAGAAAAGGTGAGGGTTGTTTTTCTTTCTCTGAAACC%0D%0ATACAGTAAATGGGTATGATTGTAGCTTCCTCAGAAATCCCTTGGCCTCCAGAGATTAAAC%0D%0AATGGTGCAATGGCACCTCTGTCCAACCTCCTTTCTGGTAGATTCCTTTCTCCTGCTTCAT%0D%0AATAGGCCAAACCTCAGGGCAAGGGAACATGGGGGTAGAGTGGTGCTGGCCAGAACCATCT%0D%0AGCTTGAGCTACTTGGTTGATTCATATCCTCTTTCCTTTATGGAGACCCATTTCCTGATCT%0D%0ACTGAGACTGTTGCTGAACTGGCAACTTACTTGGGCCTGAAACTGGAGAAGGGGTGACATT%0D%0ATTTTTAATTTCAGAGATGCTTTCTGATTTTCCTCTCCCAGGTCACTGTCTCACCTGCACT%0D%0ACTCCAAACTCAGGTTCCGGGAAGCTTGTGTGTCTAGATACTGAATTGAGATTCTGTTCAG%0D%0ACACCTTTTAGCTCTATACTCTCTGGCTCCCCTCATCCTCATGGTCACTGAATTAAATGCT%0D%0ATATTGTATTGAGAACCAAGATGGGACCTGAGGACACAAAGATGAGCTCAACAGTCTCAGC%0D%0ACCTAGAGGAATAGACTCAGGGATTTCACCAGGTCGGTGCAGTATTTGATTTCTGGTGAGG%0D%0ATGACCACAGCTGCAGTTAGGGAAGGGAGCCATTGAGCACAGACTTTGGAAGGAACCTTTT%0D%0ATTTTGTTGTTTGTTTGTTTGTTTGTTTGTTTGTTTGTTTGAGACAGGGTCTTGCTCTGTC%0D%0AACCCAGGCTGGGGCGCAATGGCACGATCTTGGCTCACTGCAACCTCTGCCTCCTGGGTTC%0D%0AAAGTGATTCTCCTGCCACAGCCTCCTGAGGAGCTGGGACTACAGGTGCGTGCTACCACGC%0D%0ACCAGCTACTTCTGTATTTTTAGTAGAGACGGGGTTTCACTGTGTTGGCCAGGCTGGTCTC%0D%0AGAACTCCTGACCTCATGATCTGCCCGCCTCAGCCTCCCAAAGTGCTGGGATTACAAGTGT%0D%0AGAGCCACCACACCTGGCCTGGAAGGAACCTCTTAAAATCAGTTTACGTCTTGTATTTTGT%0D%0ATCTGTGATGGAGGACACTGGAGAGAGTTGCTATTCCAGTCAATCATGTCGAGTCACTGGA%0D%0ACTCTGAAAATCCTATTGGTTCCTTTATTTTATTTGAGTTTAGAGTTCCCTTCTGGGTTTG%0D%0ATATTATGTCTGGCAAATGACCTGGGTTATCACTTTTCCTCCAGGGTTAGATCATAGATCT%0D%0ATGGAAACTCCTTAGAGAGCATTTTGCTCCTACCAAGGATCAGATACTGGAGCCCCACATA%0D%0AATAGATTTCATTTCACTCTAGCCTACATAGAGCTTTCTGTTGCTGTCTCTTGCCATGCAC%0D%0ATTGTGCGGTGATTACACACTTGACAGTACCAGGAGACAAATGACTTACAGATCCCCCGAC%0D%0AATGCCTCTTCCCCTTGGCAAGCTCAGTTGCCCTGATAGTAGCATGTTTCTGTTTCTGATG%0D%0ATACCTTTTTTCTCTTCTTCTTTGCATCAGCCAATTCCCAGAATTTCCCCAGGCAATTTGT%0D%0AAGAGGACCTTTTTGGGGTCCTATATGAGCCATGTCCTCAAAGCTTTTAAACCTCCTTGCT%0D%0ACTCCTACAATATTCAGTACATGACCACTGTCATCCTAGAAGGCTTCTGAAAAGAGGGGCA%0D%0AAGAGCCACTCTGCGCCACAAAGGTTGGGTCCATCTTCTCTCCGAGGTTGTGAAAGTTTTC%0D%0AAAATTGTACTAATAGGCTGGGGCCCTGACTTGGCTGTGGGCTTTGGGAGGGGTAAGCTGC%0D%0ATTTCTAGATCTCTCCCAGTGAGGCATGGAGGTGTTTCTGAATTTTGTCTACCTCACAGGG%0D%0AATGTTGTGAGGCTTGAAAAGGTCAAAAAATGATGGCCCCTTGAGCTCTTTGTAAGAAAGG%0D%0ATAGATGAAATATCGGATGTAATCTGAAAAAAAGATAAAATGTGACTTCCCCTGCTCTGTG%0D%0ACAGCAGTCGGGCTGGATGCTCTGTGGCCTTTCTTGGGTCCTCATGCCACCCCACAGCTCC%0D%0AAGGAACCTTGAAGCCAATCTGGGGGACTTTCAGATGTTTGACAAAGAGGTACCAGGCAAA%0D%0ACTTCCTGCTACACATGCCCTGAATGAATTGCTAAATTTCAAAGGAAATGGACCCTGCTTT%0D%0ATAAGGATGTACAAAAGTATGTCTGCATCGATGTCTGTACTGTAAATTTCTAATTTATCAC%0D%0ATGTACAAAGAAAACCCCTTGCTATTTAATTTTGTATTAAAGGAAAATAAAGTTTTGTTTG%0D%0ATTA&j_idt128=false&j_idt161=2&j_idt177=%3Ehsa-miR-146a-3p+MIMAT0004608%0D%0Accucugaaauucaguucuucag&j_idt227=false';
const url1 = 'https://bibiserv.cebitec.uni-bielefeld.de/applications/rnahybrid/pages/rnahybrid_function_rnahybrid_p_1.jsf';

var dataString2 = 'javax.faces.partial.ajax=true&javax.faces.source=j_idt37%3Aj_idt100&javax.faces.partial.execute=%40all&javax.faces.partial.render=j_idt37%3AparamGroup&j_idt37%3Aj_idt100=j_idt37%3Aj_idt100&j_idt37=j_idt37&j_idt37%3Arnahybrid_parameter_hits_per_target_rnahybrid_function_rnahybrid=1&j_idt37%3Arnahybrid_parameter_energy_threshold_rnahybrid_function_rnahybrid=&j_idt37%3Arnahybrid_parameter_generate_graphics_rnahybrid_function_rnahybrid=on&j_idt37%3Arnahybrid_parameter_helix_constraint_from_rnahybrid_function_rnahybrid=&j_idt37%3Arnahybrid_parameter_helix_constraint_to_rnahybrid_function_rnahybrid=&j_idt37%3Arnahybrid_parameter_max_bulge_loop_length_rnahybrid_function_rnahybrid=&j_idt37%3Arnahybrid_parameter_max_internal_loop_lenght_rnahybrid_function_rnahybrid=&j_idt37%3Arnahybrid_parameter_approximate_pvalue_rnahybrid_function_rnahybrid=human';
const url2 = 'https://bibiserv.cebitec.uni-bielefeld.de/applications/rnahybrid/pages/rnahybrid_function_rnahybrid_p_2.jsf'

var dataString3 = 'javax.faces.partial.ajax=true&javax.faces.source=j_idt37%3Aj_idt70&javax.faces.partial.execute=%40all&javax.faces.partial.render=j_idt37%3Aresulthandler&j_idt37%3Aj_idt70=j_idt37%3Aj_idt70&j_idt37=j_idt37&j_idt37%3Aj_idt41=spoolDirectory';
const url3 = 'https://bibiserv.cebitec.uni-bielefeld.de/applications/rnahybrid/pages/rnahybrid_function_rnahybrid_p_3.jsf'

const options = {
    url: 'https://bibiserv.cebitec.uni-bielefeld.de/rnahybrid/',
    headers: headers
};

function makeCookie(s){
    return `JSESSIONID=${s}`
}

async function getSessionId() {
    const res = await rp(options);
    const response = res.caseless;
    if (response && response.dict) {
        const s = response.dict['set-cookie'][0]
        console.log(s, s.substr(s.indexOf('=') +1,28));
        return s.substr(s.indexOf('='),28);
    }
    return "";
}

async function getRNAHybrid(){
    const s = await getSessionId();
    const Cookie = makeCookie(s);
    fs.writeFile("get-1-response",,()=>{})
}


getSessionId()